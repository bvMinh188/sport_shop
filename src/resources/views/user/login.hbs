<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng Nhập</title>
    <link rel="stylesheet" href="/css/auth.css">
</head>
<body class="auth-page">
    <div class="auth-container">
        <h2>Đăng Nhập</h2>
        <div id="message" class="alert"></div>

        <form id="form-login">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" name="email" placeholder="nva@gmail.com" required>
            </div>
            <div class="form-group">
                <label for="password">Mật khẩu</label>
                <input type="password" class="form-control" id="password" name="password" placeholder="*****" required>
            </div>
            <button type="submit" class="btn-primary">Đăng nhập</button>
            <div class="auth-links">
                <p>Chưa có tài khoản? <a href="/auth/register">Đăng ký ngay</a></p>
                <p><a href="/auth/forgot-password">Quên mật khẩu?</a></p>
            </div>
        </form>
    </div>

    <!-- Add jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        $(document).ready(function () {
            function showMessage(message, type) {
                const messageDiv = $("#message");
                messageDiv.removeClass("alert-danger alert-success")
                    .addClass(type === "error" ? "alert-danger" : "alert-success")
                    .text(message)
                    .show();
                
                setTimeout(() => {
                    messageDiv.fadeOut();
                }, 3000);
            }

            $("#form-login").submit(function(event) {
                event.preventDefault();

                $.ajax({
                    url: "/auth/logined",
                    method: "POST",
                    data: {
                        email: $("#email").val(),
                        password: $("#password").val()
                    },
                    success: function(response) {
                        if(response.message === 'admin') {
                            showMessage("Đăng nhập thành công!", "success");
                            setTimeout(() => {
                                window.location.href = "/admin/home";
                            }, 1500);
                        } else if(response.message === 'user') {
                            showMessage("Đăng nhập thành công!", "success");
                            setTimeout(() => {
                                window.location.href = "/";
                            }, 1500);
                        } else {
                            showMessage(response.message, "error");
                        }
                    },
                    error: function(xhr) {
                        showMessage("Đã xảy ra lỗi trong quá trình đăng nhập", "error");
                    }
                });
            });
        });
    </script>
</body>
       